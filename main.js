(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{ep:()=>A,OP:()=>O,QQ:()=>U,ud:()=>x,IM:()=>N,O9:()=>j,AO:()=>D,xZ:()=>_,Gs:()=>v,Y7:()=>p,J$:()=>C,IW:()=>k,qq:()=>h,Hf:()=>P,vc:()=>T,DW:()=>J,v1:()=>E,Qk:()=>L,IP:()=>g});var t={baseUrl:"https://nomoreparties.co/v1/plus-cohort-23",headers:{authorization:"dea51c55-7adb-49f1-89d1-5eb5c7c9ebf0","Content-Type":"application/json"}},n=function(e){return fetch("".concat(t.baseUrl,"/cards/").concat(e),{method:"DELETE",headers:t.headers,body:JSON.stringify({_id:e})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))},r=function(e){return fetch("".concat(t.baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:t.headers,body:JSON.stringify({_id:e})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))},o=function(e){return fetch("".concat(t.baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:t.headers,body:JSON.stringify({_id:e})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))};function c(e){e.classList.add("popup_opened"),document.addEventListener("keydown",s)}function a(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",s)}function s(e){"Escape"===e.key&&a(document.querySelector(".popup_opened"))}var i="";function u(e){var t=function(e,t){var a=O.querySelector(".card").cloneNode(!0),s=a.querySelector(".card__image"),u=e.likes,l=a.querySelector(".card__like-count");return s.setAttribute("src",e.link),s.setAttribute("alt",e.name),a.querySelector(".card__title").textContent=e.name,l.textContent=u.length,a.querySelector(".card__like-btn").addEventListener("click",(function(t){!function(e,t,n){t.classList.contains("card__like-btn_active")?(t.classList.remove("card__like-btn_active"),r(e).then((function(e){n.textContent=e.likes.length})).catch((function(e){console.log(e)}))):(t.classList.add("card__like-btn_active"),o(e).then((function(e){n.textContent=e.likes.length})).catch((function(e){console.log(e)})))}(e._id,t.target,l)})),s.addEventListener("click",(function(){var t,n;t=e.link,n=e.name,k.setAttribute("src",""),k.setAttribute("alt",""),k.setAttribute("src",t),k.setAttribute("alt",n),C.textContent=n,c(p)})),t._id!==i?a.querySelector(".card__trash-btn").classList.add("card__trash-btn_hidden"):a.querySelector(".card__trash-btn").addEventListener("click",(function(){n(e._id).then((function(){a.remove()})).catch((function(e){console.log(e)}))})),a}(e,e.owner);A.prepend(t)}var l,d=function(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(t)?(n.disabled=!1,n.classList.remove(e.inactiveButtonClass)):(n.disabled=!0,n.classList.add(e.inactiveButtonClass))},f=document.querySelector(".page"),m=f.querySelector(".userbox"),v=f.querySelector(".popup_edit"),_=f.querySelector(".popup_add"),p=f.querySelector(".popup_img"),h=f.querySelector(".popup_update-avatar"),y=f.querySelectorAll(".popup"),b=m.querySelector(".userbox__edit-btn"),S=m.querySelector(".userbox__add-btn"),q=m.querySelector(".userbox__avatar-container"),k=p.querySelector(".popup__img-item"),C=p.querySelector(".popup__caption-img"),L=m.querySelector(".userbox__name"),g=m.querySelector(".userbox__status"),E=m.querySelector(".userbox__avatar"),x=document.forms["edit-form"],j=x.username,P=x.status,A=f.querySelector(".cards"),O=document.querySelector("#card-template").content,U=document.forms["add-form"],D=U.placename,J=U["url-place"],N=document.forms["update_avatar-form"],T=N["url-avatar"];b.addEventListener("click",(function(){j.value=L.textContent,P.value=g.textContent,c(v)})),S.addEventListener("click",(function(){c(_)})),q.addEventListener("click",(function(){c(h)})),y.forEach((function(e){e.addEventListener("click",(function(e){var t=e.target;(t.classList.contains("popup")||t.classList.contains("popup__close-btn"))&&y.forEach((function(e){e.classList.contains("popup_opened")&&a(e)}))}))})),x.addEventListener("submit",(function(e){e.preventDefault();var n=x.querySelector(".form__btn");n.value="Сохранение...";var r,o,c=j.value,s=P.value;(r=c,o=s,fetch("".concat(t.baseUrl,"/users/me"),{method:"PATCH",headers:t.headers,body:JSON.stringify({name:r,about:o})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(e){L.textContent=e.name,g.textContent=e.about})).catch((function(e){console.log(e),L.textContent=c,g.textContent=s})).finally((function(){console.log("tutut"),n.value="Сохранить"})),a(v)})),U.addEventListener("submit",(function(e){e.preventDefault();var n,r,o=D.value,c=J.value,s=U.querySelector(".form__btn");s.value="Создание...",(n=o,r=c,fetch("".concat(t.baseUrl,"/cards"),{method:"POST",headers:t.headers,body:JSON.stringify({name:n,link:r})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(e){u(e)})).catch((function(e){console.log(e)})).finally((function(){s.value="Создание..."})),U.reset(),s.disabled=!0,a(_)})),N.addEventListener("submit",(function(e){e.preventDefault();var n=T.value,r=N.querySelector(".form__btn");r.value="Сохранение...",function(e){return fetch("".concat(t.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:t.headers,body:JSON.stringify({avatar:e})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))}(n).then((function(e){E.src=e.avatar})).catch((function(e){console.log(e)})).finally((function(){r.value="Сохранить"})),N.reset(),r.disabled=!0,a(h)})),l={formSelector:".form",inputSelector:".form__item",submitButtonSelector:".form__btn",inactiveButtonClass:"form__btn_state_inactive",inputErrorClass:"form__item_type_error",errorClass:"form__item-error_active"},Array.from(document.querySelectorAll(l.formSelector)).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),function(e,t){var n=Array.from(t.querySelectorAll(e.inputSelector)),r=t.querySelector(e.submitButtonSelector);d(e,n,r),n.forEach((function(o){o.addEventListener("input",(function(){!function(e,t,n){n.validity.patternMismatch?n.setCustomValidity(n.dataset.errorMessage):n.setCustomValidity(""),n.validity.valid?function(e,t,n){var r=t.querySelector(".".concat(n.id,"-error"));n.classList.remove(e.inputErrorClass),r.classList.remove(e.errorClass),r.textContent=""}(e,t,n):function(e,t,n,r){var o=t.querySelector(".".concat(n.id,"-error"));n.classList.add(e.inputErrorClass),o.textContent=r,o.classList.add(e.errorClass)}(e,t,n,n.validationMessage)}(e,t,o),d(e,n,r)}))}))}(l,e)})),fetch("".concat(t.baseUrl,"/cards"),{headers:t.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){e.forEach((function(e){u(e)}))})).catch((function(e){console.log(e)})),fetch("".concat(t.baseUrl,"/users/me"),{headers:t.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){L.textContent=e.name,g.textContent=e.about,E.src=e.avatar,i=e._id})).catch((function(e){console.log(e),L.textContent="Жак-Ив Кусто",g.textContent="Исследователь океана",E.src='<%=require("./images/avatar.png")%>'}))})();